!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([,function(t,e,i){"use strict";var s;i.r(e),function(t){t[t.Water=0]="Water",t[t.WaterTriangle1=1]="WaterTriangle1",t[t.WaterTriangle2=2]="WaterTriangle2",t[t.WaterTriangle3=3]="WaterTriangle3",t[t.WaterTriangle4=4]="WaterTriangle4"}(s||(s={}));var n,r=function(){return function(t,e,i,n,r){switch(this.angle=0,this.type=t,this.x=e,this.y=i,this.width=n,this.height=r,t){case s.WaterTriangle2:this.angle=90;break;case s.WaterTriangle3:this.angle=180;break;case s.WaterTriangle4:this.angle=270}}}(),a=function(){function t(t){var e=this;this.resolutionAdjustment=1,this.canvas=document.getElementById("gameScreen"),this.helperCanvas=document.getElementById("helper"),this.ctx=this.canvas.getContext("2d"),this.playerSVG=new Image,this.playerSVG.src="img/player.svg",this.playerHandSVG=new Image,this.playerHandSVG.src="img/hand.svg",this.bushSVG=new Image,this.bushSVG.src="img/bush.svg",this.rockSVG=new Image,this.rockSVG.src="img/rock.svg",this.treeSVG=new Image,this.treeSVG.src="img/tree.svg",this.cursorSVG=new Image,this.cursorSVG.src="img/cursor.svg",this.waterTrianglePNG=new Image,this.waterTrianglePNG.src="img/waterTriangle.png",this.waterTerrainData=t,this.waterTrianglePNG.onload=function(){e.saveWaterPixels("waterTriangle1"),e.saveWaterPixels("waterTriangle2"),e.saveWaterPixels("waterTriangle3"),e.saveWaterPixels("waterTriangle4")}}return t.prototype.screenResize=function(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.changeResolutionAdjustment()},t.prototype.changeResolutionAdjustment=function(){var t=(this.canvas.width/1920+this.canvas.height/1050)/2;this.resolutionAdjustment=t},t.prototype.saveWaterPixels=function(t){var e=this,i=this.helperCanvas.getContext("2d");this.helperCanvas.width=this.waterTrianglePNG.width,this.helperCanvas.height=this.waterTrianglePNG.height,i.fillStyle="#FFFFFF",i.fillRect(0,0,this.helperCanvas.width,this.helperCanvas.height);var s=this.waterTrianglePNG.width/2;switch(i.save(),i.translate(s,s),t){case"waterTriangle1":i.rotate(0*Math.PI/180);break;case"waterTriangle2":i.rotate(90*Math.PI/180);break;case"waterTriangle3":i.rotate(180*Math.PI/180);break;case"waterTriangle4":i.rotate(270*Math.PI/180)}if(i.drawImage(this.waterTrianglePNG,-s,-s),i.restore(),"undefined"!=typeof Worker){var n=new Worker("workerFindWater.js");n.onmessage=function(t){e.waterTerrainData.setData(t.data.type,t.data.data)};var r=i.getImageData(0,0,this.waterTrianglePNG.width,this.waterTrianglePNG.height).data;n.postMessage({data:r,size:this.waterTrianglePNG.width,type:t,time:(new Date).getTime()})}else console.log("Your browser doesn't support web workers.")},t.prototype.draw=function(t,e,i){var n=this.ctx;n.clearRect(0,0,this.canvas.width,this.canvas.height);var r=e.getX()+e.size/2,a=e.getY()+e.size/2,h=this.canvas.width/2,o=this.canvas.height/2;n.fillStyle="#69A2E0",n.fillRect(0,0,this.canvas.width,this.canvas.height);var c=t.blocks[1].x*this.resolutionAdjustment;n.fillStyle="#A2CB69";for(var u=0,l=t.blocks;u<l.length;u++){var g=h+((b=l[u]).x-r)*this.resolutionAdjustment,p=o+(b.y-a)*this.resolutionAdjustment;n.fillRect(g,p,c,c)}n.fillStyle="#69A2E0";for(var f=0,y=t.terrain;f<y.length;f++){var d=y[f];g=h+(d.x-r)*this.resolutionAdjustment,p=o+(d.y-a)*this.resolutionAdjustment;if(d.type===s.Water&&n.fillRect(g,p,d.width*this.resolutionAdjustment,d.height*this.resolutionAdjustment),d.type===s.WaterTriangle1&&n.drawImage(this.waterTrianglePNG,g,p,this.waterTrianglePNG.width*this.resolutionAdjustment,this.waterTrianglePNG.height*this.resolutionAdjustment),d.type===s.WaterTriangle2||d.type===s.WaterTriangle3||d.type===s.WaterTriangle4){var m=d.width/2*this.resolutionAdjustment;this.ctx.save(),this.ctx.translate(g+m,p+m),this.ctx.rotate(d.angle*Math.PI/180),this.ctx.drawImage(this.waterTrianglePNG,-m,-m,this.waterTrianglePNG.width*this.resolutionAdjustment,this.waterTrianglePNG.height*this.resolutionAdjustment),this.ctx.restore()}}n.fillStyle="gray";for(var w=0,v=t.blocks;w<v.length;w++){var b;g=h+((b=v[w]).x-r)*this.resolutionAdjustment,p=o+(b.y-a)*this.resolutionAdjustment;0===b.y&&n.fillRect(g,p,c,1),n.fillRect(g,p+c,c,1),0===b.x&&n.fillRect(g,p,1,c),n.fillRect(g+c,p,1,c)}for(var A=0;A<t.rocks.length;A++){var C=t.rocks[A];n.save(),n.globalAlpha=C.getOpacity();var k=0,P=0;switch(C.getAnimateTimer()){case 1:k=C.getHitAnimateShiftX(),P=C.getHitAnimateShiftY();break;case 2:k=2*C.getHitAnimateShiftX(),P=2*C.getHitAnimateShiftY();break;case 3:k=3*C.getHitAnimateShiftX(),P=3*C.getHitAnimateShiftY();break;case 4:k=4*C.getHitAnimateShiftX(),P=4*C.getHitAnimateShiftY();break;case 5:k=5*C.getHitAnimateShiftX(),P=5*C.getHitAnimateShiftY();break;case 6:k=4*C.getHitAnimateShiftX(),P=4*C.getHitAnimateShiftY();break;case 7:k=3*C.getHitAnimateShiftX(),P=3*C.getHitAnimateShiftY();break;case 8:k=2*C.getHitAnimateShiftX(),P=2*C.getHitAnimateShiftY();break;case 9:k=1*C.getHitAnimateShiftX(),P=1*C.getHitAnimateShiftY()}n.drawImage(this.rockSVG,h+(C.x+k-r)*this.resolutionAdjustment,o+(C.y+P-a)*this.resolutionAdjustment,C.size*this.resolutionAdjustment,C.size*this.resolutionAdjustment),n.restore()}n.fillStyle="black";for(A=0;A<t.rectangleObstacles.length;A++){var T=t.rectangleObstacles[A];n.save(),n.globalAlpha=T.getOpacity(),n.fillRect(h+(T.x-r)*this.resolutionAdjustment,o+(T.y-a)*this.resolutionAdjustment,T.width*this.resolutionAdjustment,T.height*this.resolutionAdjustment),n.restore()}for(A=0;A<e.hands.length;A++){var x=e.hands[A];n.drawImage(this.playerHandSVG,h+(x.getX()-r)*this.resolutionAdjustment,o+(x.getY()-a)*this.resolutionAdjustment,x.size*this.resolutionAdjustment,x.size*this.resolutionAdjustment);for(var O=0;O<e.hands[A].collisionPoints.length;O++){var j=e.hands[A].collisionPoints[O];g=h+(x.getCenterX()+j.x-r)*this.resolutionAdjustment,p=o+(x.getCenterY()+j.y-a)*this.resolutionAdjustment;n.fillRect(g,p,1,1)}}n.drawImage(this.playerSVG,h-e.size*this.resolutionAdjustment/2,o-e.size*this.resolutionAdjustment/2,e.size*this.resolutionAdjustment,e.size*this.resolutionAdjustment),n.fillStyle="blue";for(A=0;A<e.collisionPoints.length;A++){g=h+(j=e.collisionPoints[A]).x*this.resolutionAdjustment,p=o+j.y*this.resolutionAdjustment;n.fillRect(g,p,1,1)}for(A=0;A<t.bushes.length;A++){var Y=t.bushes[A];n.save(),n.globalAlpha=Y.getOpacity(),n.drawImage(this.bushSVG,h+(Y.x-r)*this.resolutionAdjustment,o+(Y.y-a)*this.resolutionAdjustment,Y.size*this.resolutionAdjustment,Y.size*this.resolutionAdjustment),n.restore()}for(A=0;A<t.trees.length;A++){var X=t.trees[A];n.save(),n.globalAlpha=X.getOpacity(),n.drawImage(this.treeSVG,h+(X.x-r)*this.resolutionAdjustment,o+(X.y-a)*this.resolutionAdjustment,X.size*this.resolutionAdjustment,X.size*this.resolutionAdjustment),n.restore()}n.drawImage(this.cursorSVG,i.x-25*this.resolutionAdjustment/2,i.y-25*this.resolutionAdjustment/2,25*this.resolutionAdjustment,25*this.resolutionAdjustment)},t}(),h=function(){return function(t,e){this.x=t,this.y=e}}(),o=function(){function t(t){this.size=40,this.x=0,this.y=0,this.radius=this.size/2,this.shiftAngle=40,this.hitTimer=0,this.inAction=!1,this.collisionPoints=[],this.playerRadius=t/2,this.calculateCollisionsPoints()}return t.prototype.calculateCollisionsPoints=function(){for(var t=0;t<360;t+=20){var e=Math.sin(t*Math.PI/180)*this.radius,i=Math.cos(t*Math.PI/180)*this.radius;this.collisionPoints.push(new h(e,i))}},t.prototype.ready=function(){return 0===this.hitTimer},t.prototype.getCenterX=function(){return this.x+this.radius},t.prototype.getCenterY=function(){return this.y+this.radius},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.moveHand=function(t,e,i,s,n,r){var a=this.shiftAngle,o=this.playerRadius;if(this.hitTimer>0){switch(this.hitTimer){case 20:a-=4,o+=2;break;case 19:a-=8,o+=4;break;case 18:a-=12,o+=6;break;case 17:a-=16,o+=8;break;case 16:a-=20,o+=10;break;case 15:a-=24,o+=12;break;case 14:a-=28,o+=14;break;case 13:a-=32,o+=16;break;case 12:a-=36,o+=18;break;case 11:a-=40,o+=20;break;case 10:a-=36,o+=18;break;case 9:a-=32,o+=16;break;case 8:a-=28,o+=14;break;case 7:a-=24,o+=12;break;case 6:a-=20,o+=10;break;case 5:a-=16,o+=8;break;case 4:a-=12,o+=6;break;case 3:a-=8,o+=4;break;case 2:a-=4,o+=2;break;case 1:a-=0,o+=0}if(this.inAction)for(var c=0;c<r.bushes.length;c++){if((m=r.bushes[c]).isActive()){var u=m.radius+this.radius,l=this.getCenterX()-m.getCenterX(),g=this.getCenterY()-m.getCenterY();if(Math.sqrt(l*l+g*g)<u){m.acceptHit(new h(this.getCenterX(),this.getCenterY())),this.inAction=!1;break}}}if(this.inAction)for(c=0;c<r.rocks.length;c++){if((m=r.rocks[c]).isActive()){u=m.radius+this.radius;var p=this.getCenterX()-m.getCenterX(),f=this.getCenterY()-m.getCenterY();if(Math.sqrt(p*p+f*f)<u){m.acceptHit(new h(this.getCenterX(),this.getCenterY())),this.inAction=!1;break}}}if(this.inAction)for(c=0;c<r.trees.length;c++){if((m=r.trees[c]).isActive()){u=m.radius+this.radius;var y=this.getCenterX()-m.getCenterX(),d=this.getCenterY()-m.getCenterY();if(Math.sqrt(y*y+d*d)<u){m.acceptHit(new h(this.getCenterX(),this.getCenterY())),this.inAction=!1;break}}}if(this.inAction)for(c=0;c<r.rectangleObstacles.length;c++){var m;if((m=r.rectangleObstacles[c]).isActive()&&this.x<=m.x+m.width&&this.x+this.size>=m.x&&this.y<=m.y+m.height&&this.y+this.size>=m.y)for(var w=0;w<this.collisionPoints.length;w++){var v=this.collisionPoints[w];if(m.isPointIn(new h(this.getCenterX()+v.x,this.getCenterY()+v.y))){m.acceptHit(),this.inAction=!1,console.log("hit");break}}}this.hitTimer--}var b=t+a*e;b<0&&(b=359+b),b>359&&(b-=359);var A=Math.sin(b*Math.PI/180)*o,C=Math.cos(b*Math.PI/180)*o;this.x=s+i/2+A-this.size/2,this.y=n+i/2-C-this.size/2},t.prototype.hit=function(){this.hitTimer=20,this.inAction=!0},t}(),c=function(){function t(t,e,i){this.opacity=1,this.active=!0,this.hitAnimateTimer=0,this.x=t,this.y=e,this.size=i,this.radius=i/2}return t.prototype.getHitAnimateShiftX=function(){return this.hitAnimateShiftX},t.prototype.getHitAnimateShiftY=function(){return this.hitAnimateShiftY},t.prototype.getAnimateTimer=function(){return this.hitAnimateTimer>0&&this.hitAnimateTimer--,this.hitAnimateTimer},t.prototype.isPointIn=function(t){var e=this.x+this.radius-t.x,i=this.y+this.radius-t.y;return Math.sqrt(e*e+i*i)<=this.radius},t.prototype.getCenterX=function(){return this.x+this.size/2},t.prototype.getCenterY=function(){return this.y+this.size/2},t.prototype.getOpacity=function(){return this.opacity},t.prototype.isActive=function(){return this.active},t.prototype.acceptHit=function(t){this.opacity>.1&&(this.opacity-=.1),this.setAnimateHit(t),this.opacity<.1&&(this.active=!1)},t.prototype.setAnimateHit=function(t){var e=t.x-this.getCenterX(),i=t.y-this.getCenterY(),s=Math.abs(Math.atan(e/i)*(180/Math.PI));t.x>=this.getCenterX()&&t.y<this.getCenterY()&&(s=s),t.x>=this.getCenterX()&&t.y>=this.getCenterY()&&(s=180-s),t.x<this.getCenterX()&&t.y>=this.getCenterY()&&(s=180+s),t.x<this.getCenterX()&&t.y<this.getCenterY()&&(s=360-s),360===(s=Math.round(s))&&(s=0),this.hitAnimateTimer=10;this.hitAnimateShiftX=3*Math.sin(s*Math.PI/180)*-1,this.hitAnimateShiftY=3*Math.cos(s*Math.PI/180)},t}(),u=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=function(t){function e(e,i){var s=this;return(s=t.call(this,e,i,200)||this).treeTrankRadius=35,s.opacity=.9,s}return u(e,t),e}(c),g=function(){function t(t){this.size=80,this.radius=this.size/2,this.speed=6,this.angle=0,this.hands=[],this.collisionPoints=[],this.slowAroundObstacle=!1,this.denySlowAroundObstacle=!1,this.x=550,this.y=700,this.canvas=document.getElementById("gameScreen"),this.hands.push(new o(this.size)),this.hands.push(new o(this.size)),this.map=t,this.calculateCollisionsPoints()}return t.prototype.calculateCollisionsPoints=function(){for(var t=0;t<360;t+=10){var e=Math.sin(t*Math.PI/180)*this.radius,i=Math.cos(t*Math.PI/180)*this.radius;this.collisionPoints.push(new h(e,i))}},t.prototype.getCenterX=function(){return this.x+this.radius},t.prototype.getCenterY=function(){return this.y+this.radius},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.getAngle=function(){return this.angle},t.prototype.setAngle=function(t){this.angle=t},t.prototype.hit=function(){if(this.hands[0].ready()&&this.hands[1].ready()){var t=Math.round(Math.random());this.hands[t].hit()}},t.prototype.playerMove=function(t,e,i,n,r,a){if(t||i||e||n){var h=this.speed;(t&&e||t&&n||i&&e||i&&n||this.slowAroundObstacle)&&(h/=Math.sqrt(2),this.slowAroundObstacle=!1);for(var o=0;o<this.map.terrain.length;o++)if(this.getCenterX()<this.map.terrain[o].x+this.map.terrain[o].width&&this.getCenterX()>=this.map.terrain[o].x&&this.getCenterY()<this.map.terrain[o].y+this.map.terrain[o].height&&this.getCenterY()>=this.map.terrain[o].y&&(this.map.terrain[o].type===s.Water&&(h/=2),this.map.terrain[o].type===s.WaterTriangle1||this.map.terrain[o].type===s.WaterTriangle2||this.map.terrain[o].type===s.WaterTriangle3||this.map.terrain[o].type===s.WaterTriangle4)){var c=Math.floor(this.getCenterX()-this.map.terrain[o].x),u=Math.floor(this.getCenterY()-this.map.terrain[o].y);this.map.waterTerrainData.includeWater(this.map.terrain[o].type,c,u)&&(h/=2)}var l=0,g=0;t&&(g+=-h),i&&(g+=h),e&&(l+=-h),n&&(l+=h),this.shiftOnPosition(l,g)}this.rotatePlayer(r,a),this.changeHandsPosition()},t.prototype.changeHandsPosition=function(){this.hands[0].moveHand(this.angle,-1,this.size,this.x,this.y,this.map),this.hands[1].moveHand(this.angle,1,this.size,this.x,this.y,this.map)},t.prototype.shiftOnPosition=function(t,e){var i=0;0!==t&&i++,0!==e&&i++;var s=1;e<0&&(s=-1);for(var n=0;n<Math.abs(e);n++)if(this.canIshift(0,e-n*s,i)){this.y+=e-n*s;break}s=1,t<0&&(s=-1);for(n=0;n<Math.abs(t);n++)if(this.canIshift(t-n*s,0,i)){this.x+=t-n*s;break}this.x+this.size>this.map.width&&(this.x=this.map.width-this.size),this.x<0&&(this.x=0),this.y+this.size>this.map.height&&(this.y=this.map.height-this.size),this.y<0&&(this.y=0)},t.prototype.canIshift=function(t,e,i){for(var s=0;s<this.map.rectangleObstacles.length;s++){var n=this.map.rectangleObstacles[s];if(n.isActive()&&this.x+t+this.size>=n.x&&this.x+t<=n.x+n.width&&this.y+e<=n.y+n.height&&this.y+e+this.size>=n.y)for(var r=0;r<this.collisionPoints.length;r++){var a=this.collisionPoints[r],o=new h(this.getCenterX()+t+a.x,this.getCenterY()+e+a.y);if(n.isPointIn(o))return this.goAroundRectangleObstacle(t,e,i,n),!1}}for(s=0;s<this.map.impassableRoundObstacles.length;s++){var c=this.map.impassableRoundObstacles[s];if(c.isActive()){var u=c.radius;c instanceof l&&(u=c.treeTrankRadius);var g=u+this.radius,p=this.getCenterX()+t-c.getCenterX(),f=this.getCenterY()+e-c.getCenterY();if(Math.sqrt(p*p+f*f)<g)return this.goAroundRoundObstacle(t,e,i,c),!1}}return!0},t.prototype.goAroundRectangleObstacle=function(t,e,i,s){this.slowAroundObstacle=!0;var n=.75*this.size;if(1===i&&(0!==t&&(this.getCenterY()<=s.y+s.height/2?this.y+this.size-s.y<n&&this.shiftOnPosition(0,-1):s.y+s.height-this.y<n&&this.shiftOnPosition(0,1)),0!==e&&(this.getCenterX()<=s.x+s.width/2?this.x+this.size-s.x<n&&this.shiftOnPosition(-1,0):s.x+s.width-this.x<n&&this.shiftOnPosition(1,0))),2===i)if(this.slowAroundObstacle=!1,this.getCenterX()<s.x+s.width/2&&this.getCenterY()>s.y+s.height/2)Math.abs(this.getCenterX()-s.x)<=Math.abs(this.getCenterY()-(s.y+s.height))?this.shiftOnPosition(.1,0):this.shiftOnPosition(0,-.1);else if(this.getCenterX()>s.x+s.width/2&&this.getCenterY()>s.y+s.height/2){Math.abs(this.getCenterX()-(s.x+s.width))<=Math.abs(this.getCenterY()-(s.y+s.height))?this.shiftOnPosition(-.1,0):this.shiftOnPosition(0,-.1)}else if(this.getCenterX()>s.x+s.width/2&&this.getCenterY()<s.y+s.height/2){Math.abs(this.getCenterX()-(s.x+s.width))<=Math.abs(this.getCenterY()-s.y)?this.shiftOnPosition(-.1,0):this.shiftOnPosition(0,.1)}else if(this.getCenterX()<s.x+s.width/2&&this.getCenterY()<s.y+s.height/2){Math.abs(this.getCenterX()-s.x)<=Math.abs(this.getCenterY()-s.y)?this.shiftOnPosition(.1,0):this.shiftOnPosition(0,.1)}},t.prototype.goAroundRoundObstacle=function(t,e,i,s){(this.slowAroundObstacle=!0,1===i&&(0!==t&&(this.getCenterY()>=s.getCenterY()&&this.shiftOnPosition(0,1),this.getCenterY()<s.getCenterY()&&this.shiftOnPosition(0,-1)),0!==e&&(this.getCenterX()>=s.getCenterX()&&this.shiftOnPosition(1,0),this.getCenterX()<s.getCenterX()&&this.shiftOnPosition(-1,0))),2===i)&&(Math.abs(this.getCenterX()-s.getCenterX())<=Math.abs(this.getCenterY()-s.getCenterY())?(this.getCenterX()<=s.getCenterX()&&this.shiftOnPosition(.5,0),this.getCenterX()>s.getCenterX()&&this.shiftOnPosition(-.5,0)):(this.getCenterY()<=s.getCenterY()&&this.shiftOnPosition(0,.5),this.getCenterY()>s.getCenterY()&&this.shiftOnPosition(0,-.5)))},t.prototype.rotatePlayer=function(t,e){var i=this.canvas.width/2,s=this.canvas.height/2,n=i-t,r=s-e;0===n&&(n=.1);var a=Math.abs(180*Math.atan(n/r)/Math.PI);t>=i&&e<s&&(this.angle=a),t>=i&&e>=s&&(this.angle=180-a),t<i&&e>=s&&(this.angle=180+a),t<i&&e<s&&(this.angle=360-a),this.angle=Math.round(this.angle),360===this.angle&&(this.angle=0)},t}(),p=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),f=function(t){function e(e,i){var s=this;return(s=t.call(this,e,i,100)||this).opacity=.9,s}return p(e,t),e}(c),y=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),d=function(t){function e(e,i){var s=this;return(s=t.call(this,e,i,100)||this).opacity=1,s}return y(e,t),e}(c),m=function(){function t(t,e,i,s){this.opacity=1,this.active=!0,this.x=t,this.y=e,this.width=i,this.height=s}return t.prototype.isPointIn=function(t){var e=t.x,i=t.y;return e<this.x+this.width&&e>=this.x&&i>=this.y&&i<this.y+this.height},t.prototype.getOpacity=function(){return this.opacity},t.prototype.isActive=function(){return this.active},t.prototype.acceptHit=function(){this.opacity>.1&&(this.opacity-=.1),this.opacity<.1&&(this.active=!1)},t}(),w=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),v=function(t){function e(e,i,s,n){return t.call(this,e,i,s,n)||this}return w(e,t),e}(m),b=function(){return function(t){this.blocks=[],this.terrain=[],this.impassableRoundObstacles=[],this.bushes=[],this.trees=[],this.rocks=[],this.rectangleObstacles=[],this.waterTerrainData=t,this.width=1500,this.height=1500;for(var e=0;e<this.height/300;e++)for(var i=0;i<this.width/300;i++)this.blocks.push({x:300*i,y:300*e});this.terrain.push(new r(s.Water,0,0,this.width,300)),this.terrain.push(new r(s.Water,0,this.height-300,this.width,300)),this.terrain.push(new r(s.Water,0,300,300,this.height-600)),this.terrain.push(new r(s.Water,this.width-300,300,300,this.height-600)),this.terrain.push(new r(s.WaterTriangle1,300,300,300,300)),this.terrain.push(new r(s.WaterTriangle2,900,300,300,300)),this.terrain.push(new r(s.WaterTriangle3,900,900,300,300)),this.terrain.push(new r(s.WaterTriangle4,300,900,300,300)),this.bushes.push(new f(600,600)),this.bushes.push(new f(300,400));var n=new d(100,100);this.rocks.push(n),this.impassableRoundObstacles.push(n);var a=new d(550,550);this.rocks.push(a),this.impassableRoundObstacles.push(a);var h=new d(700,550);this.rocks.push(h),this.impassableRoundObstacles.push(h);var o=new l(800,800);this.trees.push(o),this.impassableRoundObstacles.push(o),this.rectangleObstacles.push(new v(600,800,20,200)),this.rectangleObstacles.push(new v(500,900,200,20)),this.rectangleObstacles.push(new v(500,350,300,100))}}(),A=function(){function t(){this.waterTriangle1=[],this.waterTriangle2=[],this.waterTriangle3=[],this.waterTriangle4=[]}return t.prototype.setData=function(t,e){switch(t){case"waterTriangle1":this.waterTriangle1=e;break;case"waterTriangle2":this.waterTriangle2=e;break;case"waterTriangle3":this.waterTriangle3=e;break;case"waterTriangle4":this.waterTriangle4=e;break;default:throw new Error("Unknown water type")}},t.prototype.includeWater=function(t,e,i){var n,r=!1;switch(t){case s.WaterTriangle1:n=this.waterTriangle1;break;case s.WaterTriangle2:n=this.waterTriangle2;break;case s.WaterTriangle3:n=this.waterTriangle3;break;case s.WaterTriangle4:n=this.waterTriangle4;break;default:throw new Error("Unknown water type")}if(e<n.length&&i<n[e].length)n[e][i]&&(r=!0);else{if(0!==n.length)throw new Error("Out of range on water type");r=!0}return r},t}(),C=function(){function t(t,e){this.waterTerrainData=new A,this.view=new a(this.waterTerrainData),this.map=new b(this.waterTerrainData),this.player=new g(this.map),this.keys=t,this.mouse=e,this.gameLoop()}return t.prototype.gameLoop=function(){var t=this;requestAnimationFrame(function(){t.gameLoop()}),this.player.playerMove(this.keys.w,this.keys.a,this.keys.s,this.keys.d,this.mouse.x,this.mouse.y),this.mouse.left&&(this.player.hit(),this.mouse.left=!1),this.view.draw(this.map,this.player,this.mouse)},t.prototype.screenResize=function(){this.view.screenResize()},t}();(function(){function t(){var t=this;this.keys={w:!1,a:!1,s:!1,d:!1},this.mouse={x:0,y:0,left:!1,middle:!1,right:!1},this.canvas=document.getElementsByTagName("canvas")[0],this.model=new C(this.keys,this.mouse),this.model.screenResize(),window.addEventListener("resize",function(){t.model.screenResize();var e=new Event("mousemove");t.canvas.dispatchEvent(e)}),this.keysController(),this.mouseController()}return t.run=function(){if(t.instance)throw new Error("Only one controller!");t.instance=new t},t.prototype.mouseController=function(){var t=this;this.canvas.addEventListener("mousemove",function(e){null==e.x?(t.mouse.x=t.canvas.width/2,t.mouse.y=t.canvas.height/2):(t.mouse.x=e.x,t.mouse.y=e.y)}),this.canvas.addEventListener("click",function(e){t.mouse.left=!0})},t.prototype.keysController=function(){var t=this;document.addEventListener("keydown",function(e){switch(e.code){case"KeyW":t.keys.w=!0;break;case"KeyA":t.keys.a=!0;break;case"KeyS":t.keys.s=!0;break;case"KeyD":t.keys.d=!0}}),document.addEventListener("keyup",function(e){switch(e.code){case"KeyW":t.keys.w=!1;break;case"KeyA":t.keys.a=!1;break;case"KeyS":t.keys.s=!1;break;case"KeyD":t.keys.d=!1}})},t})().run()}]);
//# sourceMappingURL=app.js.map